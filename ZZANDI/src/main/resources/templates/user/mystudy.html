<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml">


<head th:replace="layout/head.html :: head">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700,800,900" rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropper/4.1.0/cropper.min.css" integrity="sha512-vmXqikRa5kmI3gOQygzml5nV+5NGxG8rt8KWHKj8JYYK12JUl2L8RBfWinFGTzvpwwsIRcINy9mhLyodnmzjig==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<section th:replace="layout/header.html :: header"></section>
<body>
<style>
    .profile-user-img-img{
        width: 150px;
        height: 150px;
        border-radius: 70%;
        overflow: hidden;
    }
    .profile-user-img{
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
</style>

<div class="wrapper d-flex align-items-stretch">
    <nav id="sidebar">
        <div class="custom-menu">
            <button type="button" id="sidebarCollapse" class="btn btn-primary">
                <i class="fa fa-bars"></i>
                <span class="sr-only">Toggle Menu</span>
            </button>
        </div>
        <div class="p-4 pt-5">
            <h1><a th:href="@{/}" class="logo">ZZANDI</a></h1>
            <ul class="list-unstyled components mb-5">
                <li class="active">
                    <a th:href="@{|/user/mypage?userNickname=${currentUser.userNickname}|}" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">회원정보수정</a>
                </li>
                <li>
                    <a th:href="@{/user/mystudy}" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">스터디관리</a>
                </li>
                <li>
                    <a href="#">기타 등등</a>
                </li>
            </ul>
        </div>
    </nav>

    <!-- Page Content  -->
    <div class = "container">
        <div th:if = "${user.id == currentUser.id}">
            <div class="border-bottom my-3 py-2 w-50">대기 중인 스터디 목록</div>
            <div class = "card my-3 w-50" th:each="teamMate : ${teamMateList}" th:if = "${teamMate.teamMateStatus.name() == 'WAITING'}">
                <div class = "card-body">
                    <a th:href = "@{|/study/detail/${teamMate.study.id}|}">
                        <span th:text = "${teamMate.study.studyTitle}"></span>
                        <span th:text = "${teamMate.study.studyStart}"></span>
                        <span th:text = "${teamMate.study.studyTag}"></span>
                        <span th:text = "${teamMate.study.studyStatus}"></span>
                    </a>
                    <form th:action="@{|/${teamMate.study.id}/teamMate/delete/${teamMate.id}|}" method="post" style="display: inline;">
                        <button type="submit" onclick = "if (!confirm('참가 신청을 취소하시겠습니까?')) return false;" class = "btn btn-outline-secondary">취소</button>
                    </form>
                </div>
            </div>

            <div class="border-bottom my-3 py-2 w-50">팀장 권한 위임 신청 목록</div>
            <div class = "card my-3 w-50" th:each="teamMate : ${teamMateList}" th:if = "${teamMate.teamMateDelegate != null} and ${teamMate.teamMateDelegate.name() == 'WAITING'}">
                <div class = "card-body">
                    <a th:href = "@{|/study/detail/${teamMate.study.id}|}">
                        <span th:text = "${teamMate.study.studyTitle}"></span>
                        <span th:text = "${teamMate.study.user.userNickname}"></span>
                    </a>
                    <form th:action="@{|/${teamMate.study.id}/teamMate/delegate|}" method="post" style="display: inline;">
                        <button type="submit" onclick = "if (!confirm('팀장 권한 위임을 수락하시겠습니까?')) return false; else alert('해당 스터디의 팀장이 되신 것을 축하드립니다.')"
                                class = "btn btn-outline-secondary">수락</button>
                    </form>
                    <form th:action="@{|/${teamMate.study.id}/teamMate/delegate/refuse|}" method="post" style="display: inline;">
                        <button type="submit" onclick = "if (!confirm('팀장 권한 위임을 거절하시겠습니까?')) return false;" class = "btn btn-outline-secondary">거절</button>
                    </form>
                </div>
            </div>
        </div>
        <div class="border-bottom my-3 py-2 w-50">모집 중인 스터디 목록</div>
        <div class = "card my-3 w-50" th:each="teamMate : ${teamMateList}" th:if = "${teamMate.study.studyStatus.name() == 'RECRUIT'} and ${teamMate.getUser == teamMate.study.user}">
            <div class = "card-body">
                <a th:href = "@{|/study/detail/${teamMate.study.id}|}">
                    <span th:text = "${teamMate.study.studyTitle}"></span>
                    <span th:text = "${teamMate.study.studyStart}"></span>
                    <span th:text = "${teamMate.study.studyTag}"></span>
                    <span th:text = "${teamMate.study.studyStatus}"></span>
                </a>
            </div>
        </div>
        <div class="border-bottom my-3 py-2 w-50">진행 중인 스터디 목록</div>
        <div class = "card my-3 w-50" th:each="teamMate : ${teamMateList}" th:if = "${teamMate.study.studyStatus.name() == 'PROGRESS'} or ${teamMate.teamMateStatus.name() == 'ACCEPTED'}">
            <div class = "card-body">
                <a th:href = "@{|/study/detail/${teamMate.study.id}|}">
                    <span th:text = "${teamMate.study.studyTitle}"></span>
                    <span th:text = "${teamMate.study.studyStart}"></span>
                    <span th:text = "${teamMate.study.studyTag}"></span>
                    <span th:text = "${teamMate.study.studyStatus}"></span>
                </a>
            </div>
        </div>

        <div class="border-bottom my-3 py-2 w-50">완료한 스터디 목록</div>
        <div class = "card my-3 w-50" th:each="teamMate : ${teamMateList}" th:if = "${teamMate.study.studyStatus.name()  == 'COMPLETE'}">
            <div class = "card-body">
                <a th:href = "@{|/study/detail/${teamMate.study.id}|}">
                    <span th:text = "${teamMate.study.studyTitle}"></span>
                    <span th:text = "${teamMate.study.studyStart}"></span>
                    <span th:text = "${teamMate.study.studyTag}"></span>
                    <span th:text = "${teamMate.study.studyStatus}"></span>
                </a>
            </div>
        </div>
    </div>
</div>
</body>
<!-- footer -->
<div th:replace="layout/footer.html :: footer"></div>

<!-- tail -->
<div th:replace="layout/tail.html :: tail"></div>
</html>